{"version":3,"sources":["../../webpack/universalModuleDefinition","../../webpack/bootstrap","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","Mrkr.ts","index.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_arrayLikeToArray","arr","len","length","arr2","Array","_toConsumableArray","isArray","iter","iterator","from","minLen","toString","slice","constructor","test","TypeError","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","configurable","writable","_defineProperty","obj","isTextNode","node","nodeType","Mrkr","element","document","body","className","selectionEnabled","onSelection","highlightClass","handlePointerUp","setElement","protoProps","staticProps","event","results","highlight","querySelectorAll","text","startOffset","endOffset","highlightedText","substring","highlightedSpanNode","createElement","classList","add","startTextNode","createTextNode","highlightedTextNode","endTextNode","appendChild","newNodes","textContent","push","textNodes","textNodesUnder","highlightedNodes","getHighlightedNodes","reduce","current","currentIndex","startFound","data","some","textNode","find","addEventListener","removeEventListener","unregister","register","offsetTargets","offsets","filter","offset","highlightedNode","childNodes","replaceWith","ends","map","Math","max","forEach","selection","window","getSelection","console","error","Error","getRangeAt","startContainer","endContainer","highlightNode","newStartNodes","newEndNodes","removeAllRanges","getData","newCurrentIndex","isEnabled","all","firstChild","nextSibling","concat","App"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Mrkr\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Mrkr\"] = factory();\n\telse\n\t\troot[\"Mrkr\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","type OffsetProps ={\n  startOffset?: number;\n  endOffset?: number;\n}\n\ntype DataProps = OffsetProps & {\n  text: string;\n}\n\n// Type guard for Text nodes\nfunction isTextNode(node: Node): node is Text {\n  return (node as Text).nodeType === 3;\n}\n\ninterface Props {\n  element?: HTMLElement;\n  className?: string;\n  selectionEnabled?: boolean;\n  onSelection?: (e: PointerEvent, data: DataProps[]) => void;\n}\n\ninterface Range {\n  startContainer: ChildNode;\n  endContainer: ChildNode;\n  startOffset: number;\n  endOffset: number;\n}\n\nexport default class Mrkr {\n  element: HTMLElement;\n  highlightClass: string;\n  onSelection: (e: PointerEvent, data: DataProps[]) => void;\n  \n  private selectionEnabled: boolean;\n\n  constructor(props: Props = {}) {\n    const { element = document.body, className = 'highlight', selectionEnabled = false, onSelection = () => {} } = props;\n\n    this.element = element;\n    this.highlightClass = className;\n    this.selectionEnabled = selectionEnabled;\n    this.onSelection = onSelection;\n    \n    this.handlePointerUp = this.handlePointerUp.bind(this);\n\n    this.setElement(element);\n  }\n\n  private handlePointerUp(event: PointerEvent) {\n    if (this.selectionEnabled) {\n      const results = this.highlight();\n\n      this.onSelection(event, results);\n    }\n  }\n\n  private getHighlightedNodes(): HTMLElement[] {\n    if (!this.element) return [];\n\n    return Array.from(this.element.querySelectorAll(`.${this.highlightClass}`));\n  }\n\n  private highlightNode (text: string | null = '', startOffset: number, endOffset: number): ChildNode[] {\n    if (!text) return [];\n\n    const highlightedText = text.substring(startOffset, endOffset);\n  \n    if (highlightedText.length > 0) {\n      const highlightedSpanNode = document.createElement('SPAN');\n      highlightedSpanNode.classList.add(this.highlightClass);\n    \n      const startTextNode = document.createTextNode(text.substring(0, startOffset));\n      const highlightedTextNode = document.createTextNode(highlightedText);\n      const endTextNode = document.createTextNode(text.substring(endOffset));\n    \n      highlightedSpanNode.appendChild(highlightedTextNode);\n    \n      const newNodes = [];\n      if (startTextNode.textContent) newNodes.push(startTextNode);\n      newNodes.push(highlightedSpanNode);\n      if (endTextNode.textContent) newNodes.push(endTextNode);\n    \n      return newNodes;\n    }\n    \n    return [document.createTextNode(text)];\n  }\n\n  getData(): DataProps[] {\n    if (!this.element) return [];\n\n    const textNodes = textNodesUnder(this.element);\n    const highlightedNodes = this.getHighlightedNodes().reduce((arr: Text[], current) => [...arr,  ...textNodesUnder(current)], []);\n\n    let currentIndex = 0;\n\n    let startFound = false;\n\n    const data: DataProps[] = [];\n    \n    textNodes.some((textNode) => {\n      if (!textNode.textContent) return false;\n\n      const highlightedNode = highlightedNodes.find((node) => node === textNode);\n\n      if (highlightedNode) {\n        if (!startFound) {\n          data.push({\n            startOffset: currentIndex,\n            text: textNode.textContent,\n          });\n\n          startFound = true;\n        } else {\n          data[data.length - 1].text += textNode.textContent;\n        }\n      } else if (startFound) {\n        data[data.length - 1].endOffset = currentIndex + textNode.textContent.length;\n        startFound = false;\n      }\n\n      currentIndex += textNode.textContent.length;\n    });\n\n    return data;\n  }\n\n  register() {\n    this.element.addEventListener('pointerup', this.handlePointerUp);\n  }\n\n  unregister() {\n    this.element.removeEventListener('pointerup', this.handlePointerUp);\n  }\n  \n  setElement(element: HTMLElement) {\n    this.unregister();\n    this.element = element;\n    this.register();\n  }\n\n  clear(offsetTargets?: OffsetProps[]): void {\n    if (!this.element) return;\n\n    // Guard against bad offset inputs\n    const offsets = offsetTargets?.filter((o) => o && o.startOffset && o.endOffset);\n\n    const highlightedNodes = this.getHighlightedNodes();\n    const textNodes = textNodesUnder(this.element);\n\n    // If offsets array not included, clear all\n    if (!offsets) {\n      highlightedNodes.forEach((highlightedNode) => {\n        highlightedNode.replaceWith(...Array.from(highlightedNode.childNodes));\n      });\n    } else {\n      // Clear all highlighted text that falls between the offsets in the passed offsets array\n      let currentIndex = 0;\n\n      // Clear any text nodes that fall inside any of the offset ranges passed\n      textNodes.some((textNode) => {\n        if (offsets.find((offset) => offset.startOffset && offset.endOffset && (currentIndex >= offset.startOffset && currentIndex <= offset.endOffset))) {\n          const highlightedNode = highlightedNodes.find((node) => !!Array.from(node.childNodes).find((n => n === textNode)));\n          if (highlightedNode) {\n            highlightedNode.replaceWith(...Array.from(highlightedNode.childNodes));\n          }\n        }\n\n        // Can stop searching\n        const ends = offsets.map((offset) => offset.endOffset).filter(n => typeof n === 'number') as number[];\n        if (currentIndex > Math.max(...ends)) {\n          return true;\n        }\n\n        currentIndex += textNode.textContent?.length || 0;\n        return false;\n      });\n    }\n  }\n\n  highlight(): DataProps[] {\n    const selection = window.getSelection();\n    let results: DataProps[] = [];\n\n    // If there's no selection object\n    if (!selection) return results;\n\n    // Container element must be defined\n    if (!this.element) {\n      console.error(new Error('Container element not defined for highlighter.'));\n      return results;\n    } \n    \n    const range = selection.getRangeAt(0);\n    \n    const { startContainer, endContainer, startOffset, endOffset } = range as unknown as Range;\n\n    // Ensure that results are Text nodes\n    if (isTextNode(startContainer) && isTextNode(endContainer)) {\n      const startTextNode = startContainer;\n      const endTextNode = endContainer;\n\n      // If no content's actually been selected\n      if (startTextNode === endTextNode && endOffset === startOffset) return results;\n  \n      if (startTextNode === endTextNode) {\n        // If the selection occurs inside the same text node\n        const newNodes = this.highlightNode(startTextNode.textContent, startOffset, endOffset) as ChildNode[];\n        startTextNode.replaceWith(...newNodes);\n      } else {\n        const textNodes = textNodesUnder(this.element);\n  \n        let startFound = false;\n        textNodes.some((textNode) => {\n          if (!textNode.textContent) return false;\n  \n          // Handle highlighting the starting text node\n          if (textNode === startTextNode) {\n            const newStartNodes = this.highlightNode(textNode.textContent, startOffset, textNode.textContent.length);\n            textNode.replaceWith(...newStartNodes);\n  \n            // Start collecting text nodes in between\n            startFound = true;\n            \n            return false;\n          } else if (textNode === endTextNode) {\n            // Handle highlighting the end text node\n            const newEndNodes = this.highlightNode(textNode.textContent, 0, endOffset);\n            textNode.replaceWith(...newEndNodes);\n  \n            return true; // Stop the loop\n          } else if (startFound) {\n            // Handle highlighting nodes in between start and end\n            const newEndNodes = this.highlightNode(textNode.textContent, 0, textNode.textContent.length);\n            textNode.replaceWith(...newEndNodes);\n          }\n          \n          return false;\n        });\n      }\n      selection.removeAllRanges();\n\n      return this.getData();\n    }\n\n    return results;\n  }\n\n  highlightRange(startOffset: number, endOffset: number): DataProps[] {\n    let results: DataProps[] = []\n\n    if (!this.element) {\n      console.error(new Error('Container element not defined for highlighter.'))\n      return results;\n    };\n\n    const textNodes = textNodesUnder(this.element);\n    \n    let currentIndex = 0;\n    let startFound = false;\n\n    textNodes.some((textNode) => {\n      if (!textNode.textContent) return false;\n\n      const newCurrentIndex = currentIndex + (textNode.textContent.length || 0);\n      if (startOffset >= currentIndex && startOffset < newCurrentIndex) {\n        const newNodes = this.highlightNode(textNode.textContent, startOffset - currentIndex, textNode.textContent.length);\n        textNode.replaceWith(...newNodes);\n        startFound = true;\n      } else if (endOffset >= currentIndex && endOffset < newCurrentIndex) {\n        const newNodes = this.highlightNode(textNode.textContent, 0, endOffset - currentIndex);\n        textNode.replaceWith(...newNodes);\n        return true;\n      } else if (startFound) {\n        const newNodes = this.highlightNode(textNode.textContent, 0, textNode.textContent.length);\n        textNode.replaceWith(...newNodes);\n      }\n\n      currentIndex = newCurrentIndex;\n      return false;\n    });\n\n    return this.getData();\n  }\n\n  getSelectionEnabled() {\n    return this.selectionEnabled;\n  }\n\n  toggleSelection(isEnabled: boolean) {\n    this.selectionEnabled = isEnabled;\n  }\n\n  enableSelection() {\n    this.selectionEnabled = true;\n  }\n\n  disableSelection() {\n    this.selectionEnabled = false;\n  }\n}\n\n/**\n * Gets an array of text nodes under the passed node\n *\n * @param {HTMLElement} node\n * @returns {[HTMLElement]} - array of text nodes\n */\n const textNodesUnder = (node: HTMLElement): Text[] => {\n  let all: Text[] = [];\n\n  // @ts-ignore\n  for (node = node.firstChild; node; node = node.nextSibling) {\n    if (isTextNode(node)) all.push(node);\n    else all = all.concat(textNodesUnder(node));\n  }\n  return all;\n};\n","import App from './Mrkr';\nexport default App;"],"sourceRoot":""}