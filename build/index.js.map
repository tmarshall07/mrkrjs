{"version":3,"sources":["../../webpack/universalModuleDefinition","../../webpack/bootstrap","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js","../../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","Mrkr.ts","index.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_arrayLikeToArray","arr","len","length","arr2","Array","_toConsumableArray","isArray","iter","iterator","from","minLen","toString","slice","constructor","test","TypeError","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","configurable","writable","_defineProperty","obj","isTextNode","node","nodeType","isValidOffset","offset","startOffset","endOffset","Mrkr","startContainer","endContainer","textNodes","textNodesUnder","element","currentIndex","absoluteStartOffset","undefined","absoluteEndOffset","some","textNode","textContent","document","body","className","selectionEnabled","onSelection","highlightClass","handlePointerUp","setElement","protoProps","staticProps","event","results","highlight","querySelectorAll","text","highlightedText","substring","highlightedSpanNode","createElement","classList","add","startTextNode","createTextNode","highlightedTextNode","endTextNode","appendChild","newNodes","push","highlightedTextNodes","getHighlightedNodes","reduce","current","startFound","data","find","addEventListener","removeEventListener","unregister","register","offsetTargets","offsets","filter","highlightedNodes","highlightedNode","childNodes","replaceWith","ends","map","Math","max","forEach","selection","window","getSelection","console","error","Error","range","getRangeAt","getAbsoluteOffsets","highlightRange","removeAllRanges","getData","newCurrentIndex","highlightNode","isEnabled","all","firstChild","nextSibling","concat","App"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Mrkr\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Mrkr\"] = factory();\n\telse\n\t\troot[\"Mrkr\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","type OffsetProps ={\n  startOffset?: number;\n  endOffset?: number;\n}\n\ntype DataProps = OffsetProps & {\n  text: string;\n}\n\n// Type guard for Text nodes\nfunction isTextNode(node: Node): node is Text {\n  return (node as Text).nodeType === 3;\n}\n\n// Type guard for offset\nfunction isValidOffset(offset?: OffsetProps): offset is { startOffset: number; endOffset: number } {\n  return !!(offset && typeof offset.startOffset === 'number' && typeof offset.endOffset === 'number');\n}\n\ninterface Props {\n  element?: HTMLElement;\n  className?: string;\n  selectionEnabled?: boolean;\n  onSelection?: (e: PointerEvent, data: DataProps[]) => void;\n}\n\ninterface Range {\n  startContainer: ChildNode;\n  endContainer: ChildNode;\n  startOffset: number;\n  endOffset: number;\n}\n\nexport default class Mrkr {\n  element: HTMLElement;\n  highlightClass: string;\n  onSelection: (e: PointerEvent, data: DataProps[]) => void;\n  \n  private selectionEnabled: boolean;\n\n  constructor(props: Props = {}) {\n    const { element = document.body, className = 'highlight', selectionEnabled = false, onSelection = () => {} } = props;\n\n    this.element = element;\n    this.highlightClass = className;\n    this.selectionEnabled = selectionEnabled;\n    this.onSelection = onSelection;\n    \n    this.handlePointerUp = this.handlePointerUp.bind(this);\n\n    this.setElement(element);\n  }\n\n  /**\n   * Callback run on pointerup\n   *\n   * @private\n   * @param {PointerEvent} event\n   * @memberof Mrkr\n   */\n  private handlePointerUp(event: PointerEvent) {\n    if (this.selectionEnabled) {\n      const results = this.highlight();\n\n      this.onSelection(event, results);\n    }\n  }\n\n  /**\n   * Gets all nodes that have the current className\n   *\n   * @private\n   * @returns {HTMLElement[]}\n   * @memberof Mrkr\n   */\n  private getHighlightedNodes(): HTMLElement[] {\n    if (!this.element) return [];\n\n    return Array.from(this.element.querySelectorAll(`.${this.highlightClass}`));\n  }\n\n  /**\n   * Creates a set of highlighted and non-highlighted nodes to replace the passed text content\n   *\n   * @private\n   * @param {(string | null)} [text='']\n   * @param {number} startOffset\n   * @param {number} endOffset\n   * @returns {ChildNode[]}\n   * @memberof Mrkr\n   */\n  private highlightNode (text: string | null = '', startOffset: number, endOffset: number): ChildNode[] {\n    if (!text) return [];\n\n    const highlightedText = text.substring(startOffset, endOffset);\n  \n    if (highlightedText.length > 0) {\n      const highlightedSpanNode = document.createElement('SPAN');\n      highlightedSpanNode.classList.add(this.highlightClass);\n    \n      const startTextNode = document.createTextNode(text.substring(0, startOffset));\n      const highlightedTextNode = document.createTextNode(highlightedText);\n      const endTextNode = document.createTextNode(text.substring(endOffset));\n    \n      highlightedSpanNode.appendChild(highlightedTextNode);\n    \n      const newNodes = [];\n      if (startTextNode.textContent) newNodes.push(startTextNode);\n      newNodes.push(highlightedSpanNode);\n      if (endTextNode.textContent) newNodes.push(endTextNode);\n    \n      return newNodes;\n    }\n    \n    return [document.createTextNode(text)];\n  }\n\n  /**\n   * Converts relative range offset data to absolute offsets\n   *\n   * @private\n   * @memberof Mrkr\n   */\n  private getAbsoluteOffsets = (startContainer: Text, startOffset: number, endContainer: Text, endOffset: number): OffsetProps => {\n    const textNodes = textNodesUnder(this.element);\n    let currentIndex = 0;\n    let absoluteStartOffset = undefined;\n    let absoluteEndOffset  = undefined;\n\n    textNodes.some((textNode) => {\n      if (!textNode?.textContent) return false;\n      \n      if (textNode === startContainer) {\n        absoluteStartOffset = currentIndex + startOffset;\n      }\n\n      if (textNode === endContainer) {\n        absoluteEndOffset = currentIndex + endOffset;\n        return true;\n      }\n\n      currentIndex = currentIndex + textNode.textContent.length;\n      return false;\n    });\n\n    if (absoluteStartOffset && absoluteEndOffset) {\n      return { startOffset: absoluteStartOffset, endOffset: absoluteEndOffset };\n    }\n\n    return {};\n  }\n\n  /**\n   * Searches the container element for any highlighted nodes\n   * according to the current className\n   *\n   * @returns {DataProps[]}\n   * @memberof Mrkr\n   */\n  getData(): DataProps[] {\n    if (!this.element) return [];\n\n    const textNodes = textNodesUnder(this.element);\n    const highlightedTextNodes = this.getHighlightedNodes().reduce((arr: Text[], current) => [...arr,  ...textNodesUnder(current)], []);\n\n    let currentIndex = 0;\n\n    let startFound = false;\n\n    const data: DataProps[] = [];\n    \n    textNodes.some((textNode, i) => {\n      if (!textNode.textContent) return false;\n\n      const highlightedTextNode = highlightedTextNodes.find((node) => node === textNode);\n\n      if (highlightedTextNode) {\n        if (!startFound) {\n          data.push({\n            startOffset: currentIndex,\n            text: textNode.textContent,\n          });\n\n          startFound = true;\n\n        } else {\n          data[data.length - 1].text += textNode.textContent;\n        }\n\n        // If this node is also the last node\n        if (i === textNodes.length - 1) {\n          data[data.length - 1].endOffset = currentIndex + textNode.textContent.length;\n        }\n      } else if (startFound) {\n        data[data.length - 1].endOffset = currentIndex;\n        startFound = false;\n      }\n\n      currentIndex += textNode.textContent.length;\n    });\n\n    return data;\n  }\n\n  /**\n   * Adds the event listener for pointerup\n   *\n   * @memberof Mrkr\n   */\n  register() {\n    this.element.addEventListener('pointerup', this.handlePointerUp);\n  }\n\n  /**\n   * Removes the event listener for pointerup\n   *\n   * @memberof Mrkr\n   */\n  unregister() {\n    this.element.removeEventListener('pointerup', this.handlePointerUp);\n  }\n  \n  /**\n   * Sets the current container element\n   *\n   * @param {HTMLElement} element\n   * @memberof Mrkr\n   */\n  setElement(element: HTMLElement) {\n    this.unregister();\n    this.element = element;\n    this.register();\n  }\n\n  /**\n   * Clears all or part of the highlighted text blocks\n   *\n   * @param {OffsetProps[]} [offsetTargets] - optional array of offsets to target and remove\n   * @returns {void}\n   * @memberof Mrkr\n   */\n  clear(offsetTargets?: OffsetProps[]): void {\n    if (!this.element) return;\n\n    // Guard against bad offset inputs\n    const offsets = offsetTargets?.filter((o) => isValidOffset(o));\n\n    const highlightedNodes = this.getHighlightedNodes();\n    const textNodes = textNodesUnder(this.element);\n\n    // If offsets array not included, clear all\n    if (!offsets) {\n      highlightedNodes.forEach((highlightedNode) => {\n        highlightedNode.replaceWith(...Array.from(highlightedNode.childNodes));\n      });\n    } else {\n      // Clear all highlighted text that falls between the offsets in the passed offsets array\n      let currentIndex = 0;\n\n      // Clear any text nodes that fall inside any of the offset ranges passed\n      textNodes.some((textNode) => {\n        if (offsets.find((offset) => isValidOffset(offset) && (currentIndex >= offset.startOffset && currentIndex <= offset.endOffset))) {\n          const highlightedNode = highlightedNodes.find((node) => !!Array.from(node.childNodes).find((n => n === textNode)));\n          if (highlightedNode) {\n            highlightedNode.replaceWith(...Array.from(highlightedNode.childNodes));\n          }\n        }\n\n        // Can stop searching\n        const ends = offsets.map((offset) => offset.endOffset).filter(n => typeof n === 'number') as number[];\n        if (currentIndex > Math.max(...ends)) {\n          return true;\n        }\n\n        currentIndex += textNode.textContent?.length || 0;\n        return false;\n      });\n    }\n  }\n\n  highlight(): DataProps[] {\n    const selection = window.getSelection();\n    let results: DataProps[] = [];\n\n    // If there's no selection object\n    if (!selection) return results;\n\n    // Container element must be defined\n    if (!this.element) {\n      console.error(new Error('Container element not defined for highlighter.'));\n      return results;\n    } \n    \n    const range = selection.getRangeAt(0);\n    \n    const { startContainer, endContainer } = range as unknown as Range;\n    \n    // Ensure that results are Text nodes\n    if (isTextNode(startContainer) && isTextNode(endContainer)) {\n      const startTextNode = startContainer;\n      const endTextNode = endContainer;\n\n      // If no content's actually been selected\n      if (startTextNode === endTextNode && range.endOffset === range.startOffset) return results;\n\n      // Convert to absolute offsets in the element\n      const offsets = this.getAbsoluteOffsets(startContainer, range.startOffset, endContainer, range.endOffset);\n\n      if (isValidOffset(offsets)) {\n        this.highlightRange(offsets.startOffset, offsets.endOffset);\n      }\n\n      selection.removeAllRanges();\n\n      return this.getData();\n    }\n\n    return results;\n  }\n\n  /**\n   * Highlights a range of text determined by start and end offsets\n   *\n   * @param {number} startOffset - absolute offset in the element container\n   * @param {number} endOffset - absolute offset in the element container\n   * @returns {DataProps[]}\n   * @memberof Mrkr\n   */\n  highlightRange(startOffset: number, endOffset: number): DataProps[] {\n    let results: DataProps[] = [];\n\n    if (!this.element) {\n      console.error(new Error('Container element not defined for highlighter.'))\n      return results;\n    };\n\n    const textNodes = textNodesUnder(this.element);\n    \n    let currentIndex = 0;\n    let startFound = false;\n\n    textNodes.some((textNode) => {\n      if (!textNode.textContent) return false;\n\n      const newCurrentIndex = currentIndex + textNode.textContent.length;\n      if (startOffset >= currentIndex && startOffset < newCurrentIndex) {\n        const newNodes = this.highlightNode(textNode.textContent, startOffset - currentIndex, endOffset - currentIndex);\n        textNode.replaceWith(...newNodes);\n  \n        // Start collecting text nodes in between\n        startFound = true;\n      }\n      \n      if (endOffset >= currentIndex && endOffset < newCurrentIndex) {\n        const newNodes = this.highlightNode(textNode.textContent, 0, endOffset - currentIndex);\n        textNode.replaceWith(...newNodes);\n        \n        // End the loop\n        return true;\n      } else if (startFound) {\n        const newNodes = this.highlightNode(textNode.textContent, 0, textNode.textContent.length);\n        textNode.replaceWith(...newNodes);\n      }\n\n      currentIndex = newCurrentIndex;\n      return false;\n    });\n\n    return this.getData();\n  }\n\n  getSelectionEnabled() {\n    return this.selectionEnabled;\n  }\n\n  toggleSelection(isEnabled: boolean) {\n    this.selectionEnabled = isEnabled;\n  }\n\n  enableSelection() {\n    this.selectionEnabled = true;\n  }\n\n  disableSelection() {\n    this.selectionEnabled = false;\n  }\n}\n\n/**\n * Gets an array of text nodes under the passed node\n *\n * @param {HTMLElement} node\n * @returns {[HTMLElement]} - array of text nodes\n */\n const textNodesUnder = (node: HTMLElement): Text[] => {\n  let all: Text[] = [];\n\n  // @ts-ignore\n  for (node = node.firstChild; node; node = node.nextSibling) {\n    if (isTextNode(node)) all.push(node);\n    else all = all.concat(textNodesUnder(node));\n  }\n  return all;\n};\n","import App from './Mrkr';\nexport default App;"],"sourceRoot":""}