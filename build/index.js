/*!
 * 
 *   mrkrjs v1.2.0
 *   https://github.com/tmarshall/mrkrjs
 * 
 *   Copyright (c) Tanner Marshall (https://github.com/tmarshall07)
 * 
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *   
 */
!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define("Mrkr",[],t):"object"===typeof exports?exports.Mrkr=t():e.Mrkr=t()}(this,(function(){return function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){"use strict";function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _toConsumableArray(e){return function(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function isTextNode(e){return 3===e.nodeType}function isValidOffset(e){return!(!e||"number"!==typeof e.startOffset||"number"!==typeof e.endOffset)}n.r(t);var r=function textNodesUnder(e){var t=[];for(e=e.firstChild;e;e=e.nextSibling)isTextNode(e)?t.push(e):t=t.concat(textNodesUnder(e));return t},i=function(){function Mrkr(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Mrkr),_defineProperty(this,"element",void 0),_defineProperty(this,"highlightClass",void 0),_defineProperty(this,"maximum",void 0),_defineProperty(this,"minimum",void 0),_defineProperty(this,"overlap",void 0),_defineProperty(this,"onSelection",void 0),_defineProperty(this,"selectionEnabled",void 0),_defineProperty(this,"getAbsoluteOffsets",(function(t,n,i,o){var a,s,u=r(e.element),l=0;return u.some((function(e){return!!(null===e||void 0===e?void 0:e.textContent)&&(e===t&&(a=l+n),e===i?(s=l+o,!0):(l+=e.textContent.length,!1))})),a&&s?{startOffset:a,endOffset:s}:{}}));var n=t.element,i=void 0===n?document.body:n,o=t.className,a=void 0===o?"highlight":o,s=t.selectionEnabled,u=void 0!==s&&s,l=t.onSelection,f=t.maximum,c=void 0===f?void 0:f,d=t.minimum,h=void 0===d?void 0:d,_=t.overlap,p=void 0===_||_;this.element=i,this.highlightClass=a,this.selectionEnabled=u,this.maximum=c,this.minimum=h,this.overlap=p,this.onSelection=l,this.handlePointerUp=this.handlePointerUp.bind(this),this.setElement(i)}var e,t,n;return e=Mrkr,(t=[{key:"handlePointerUp",value:function(e){if(this.selectionEnabled){var t=this.highlight();this.onSelection&&this.onSelection(e,t)}}},{key:"getHighlightedNodes",value:function(e){return this.element?Array.from(this.element.querySelectorAll(".".concat(e||this.highlightClass))):[]}},{key:"highlightNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(!e)return[];var r=e.substring(t,n);if(r.length>0){var i=document.createElement("SPAN");i.classList.add(this.highlightClass);var o=document.createTextNode(e.substring(0,t)),a=document.createTextNode(r),s=document.createTextNode(e.substring(n));i.appendChild(a);var u=[];return o.textContent&&u.push(o),u.push(i),s.textContent&&u.push(s),u}return[document.createTextNode(e)]}},{key:"getData",value:function(e){if(!this.element)return[];var t=r(this.element),n=this.getHighlightedNodes(e).reduce((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(r(t)))}),[]),i=0,o=!1,a=[];return t.some((function(e,r){if(!e.textContent)return!1;var s=n.find((function(t){return t===e}));return s?(o?(a[a.length-1].text+=e.textContent,a[a.length-1].nodes.push(s)):(a.push({startOffset:i,text:e.textContent,nodes:[s]}),o=!0),r===t.length-1&&(a[a.length-1].endOffset=i+e.textContent.length)):o&&(a[a.length-1].endOffset=i,o=!1),i+=e.textContent.length,!1})),a}},{key:"register",value:function(){this.element.addEventListener("pointerup",this.handlePointerUp)}},{key:"unregister",value:function(){this.element.removeEventListener("pointerup",this.handlePointerUp)}},{key:"setElement",value:function(e){this.unregister(),this.element=e,this.register()}},{key:"clear",value:function(e){if(this.element){var t=null===e||void 0===e?void 0:e.filter((function(e){return isValidOffset(e)})),n=this.getHighlightedNodes(),i=r(this.element);if(t){var o=0;i.some((function(e){var r;if(t.find((function(e){return isValidOffset(e)&&o>=e.startOffset&&o<=e.endOffset}))){var i=n.find((function(t){return!!Array.from(t.childNodes).find((function(t){return t===e}))}));i&&i.replaceWith.apply(i,_toConsumableArray(Array.from(i.childNodes)))}var a=t.map((function(e){return e.endOffset})).filter((function(e){return"number"===typeof e}));return o>Math.max.apply(Math,_toConsumableArray(a))||(o+=(null===(r=e.textContent)||void 0===r?void 0:r.length)||0,!1)}))}else n.forEach((function(e){e.replaceWith.apply(e,_toConsumableArray(Array.from(e.childNodes)))}))}}},{key:"highlight",value:function(){var e=window.getSelection(),t=[];if(!e)return t;if(!this.element)return console.error(new Error("Container element not defined for highlighter.")),t;var n=e.getRangeAt(0),r=n,i=r.startContainer,o=r.endContainer;if(isTextNode(i)&&isTextNode(o)){if(i===o&&n.endOffset===n.startOffset)return t;var a=this.getAbsoluteOffsets(i,n.startOffset,o,n.endOffset);if(e.removeAllRanges(),a.startOffset&&a.endOffset){var s=a.endOffset-a.startOffset,u=a.startOffset,l=a.endOffset;if(this.minimum&&!(s>=this.minimum)||this.maximum&&!(s<=this.maximum))return t;if(!this.overlap&&this.getData().some((function(e){return e.startOffset&&e.endOffset&&(u>e.startOffset&&u<e.endOffset||l>e.startOffset&&l<e.endOffset)})))return t}return isValidOffset(a)&&this.highlightRange(a.startOffset,a.endOffset),this.getData()}return t}},{key:"highlightRange",value:function(e,t){var n=this;if(!this.element)return console.error(new Error("Container element not defined for highlighter.")),[];var i=r(this.element),o=0,a=!1;return i.some((function(r){if(!r.textContent)return!1;var i=o+r.textContent.length;if(e>=o&&e<i){var s=n.highlightNode(r.textContent,e-o,t-o);r.replaceWith.apply(r,_toConsumableArray(s)),a=!0}if(t>=o&&t<i){var u=n.highlightNode(r.textContent,0,t-o);return r.replaceWith.apply(r,_toConsumableArray(u)),!0}if(a){var l=n.highlightNode(r.textContent,0,r.textContent.length);r.replaceWith.apply(r,_toConsumableArray(l))}return o=i,!1})),this.getData()}},{key:"getSelectionEnabled",value:function(){return this.selectionEnabled}},{key:"toggleSelection",value:function(e){this.selectionEnabled=e}},{key:"enableSelection",value:function(){this.selectionEnabled=!0}},{key:"disableSelection",value:function(){this.selectionEnabled=!1}}])&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Mrkr}();t.default=i}]).default}));
//# sourceMappingURL=index.js.map